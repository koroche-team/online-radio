version: '3.1'

services:
  icecast:
    image: infiniteproject/icecast
    ports:
      - "8000:8000"
    environment:
      ICE_RADIO_MAX_SOURCES: 10
      ICECAST_SOURCE_PASSWORD: <icecast-password>
      ICECAST_HOSTNAME: online-radio

  online-radio-api:
    build: ./online-radio-api
    image: onlineradio.azurecr.io/online-radio-api
    volumes:
      - data-volume:/covers
    ports:
      - "8080:8080"

volumes:
  data-volume:
    driver: azure_file
    driver_opts:
      share_name: online-radio-volume
      storage_account_name: onlineradio
